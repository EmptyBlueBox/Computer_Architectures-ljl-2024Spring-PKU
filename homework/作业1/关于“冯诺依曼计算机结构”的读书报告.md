# First Draft of a Report on the EDVAC 读书报告

  <center>
    北京大学 2024 春季计算机组织与体系结构课程作业
  </center>


---

<center>
  Arthals 2110306206
  <br/>
  <pre>zhuozhiyongde@126.com</pre>
  2024.03
</center>

---

## 报告摘要

### 第一章：定义

在本章中，作者首先定义了有关自动计算系统（也即计算机）的一些术语，并首先指出其是一种能够执行复杂计算指令的设备，但是想要使用它的能力，必须先提供详尽的指令。

这包括所有必要的数值信息，如变量的初始和边界值、常数值、问题描述中的固定函数表等。而一旦这些信息被提供，计算机就能够自动地执行一系列的计算步骤，直到得到最终的结果。

在此过程中，他还重点指出了，自动计算系统存在故障的可能性，而一旦出现故障，就需要人工对之进行识别与修正。

### 第二章：系统的主要细分部分

本章主要总结了 EDVAC 的设计，并籍此分析了计算机所需的物理结构，这包括以下部分：

-   中央算数器（Central Arithmetic, CA）
-   中央控制器（Central Control, CC）
-   存储器（Memory, M）
-   输入设备（Input, I）
-   输出设备（Output, O）

而这，正是冯诺依曼结构的五大组成部分。

除此之外，作者还提到了外部记录介质（R）。作者指出，除非能完全依靠 M 而不是 R 来满足运算所需，否则 R 一定会因为速度慢而成为系统的瓶颈。

### 第三章：讨论程序

在本章中，作者主要强调了第二章所说的五个部分之间的相互依赖性，指出了他们应当被作为一个整体一起讨论，而不能被孤立地讨论。这就要求我们深入理解各个部分的功能和特性（包括对应的物理装置），以及它们如何相互作用，共同实现整体的功能。

本章还指出了我们要额外关注检测故障的程序。

### 第四章：元素、同步、神经元类比

在本章中，作者以高等动物的神经元作为引子，首先提到了神经元具有的两种状态：静息和兴奋。进而对之进行类比，提到了这种简单的模式可以以真空管作为物理基础，构建一个 “二值的算数系统”，其复杂度较小，响应时间极短且可靠，组合起来也能够实现复杂的运算，这也就是后世二进制的雏形。

### 第五章：算术运算的基本原则

在本章中，作者就二进制实现算术运算展开了讨论，指出了其具有更简单统一的逻辑结构的优势，虽然我们可能觉得十进制更为直观，但是只需要在输入输出和显示的时候使用 CA 进行转换即可。

进一步的，作者关注了在实现上的细节。二进制可以极大地简化乘除法操作，但是由于转换了进制，相对的，我们需要提升运算的位数，这就会需要更复杂的逻辑电路，也就要求我们在运算速度和电路复杂程度之间进行权衡。

### 第六章： E 元件

在本章中，作者深入讨论了电子数字计算机的基本组成。作者首先假设这些电子元件的功能类似于真空管以简化讨论。接着，作者还估计了这些元件之间的传导时间，由于真实的真空管延迟极小，所以线路较短的话，可以忽略不计。最后，作者讨论了复杂电路中，平均来讲，每个元件可能需要 1-2 个真空管来实现其功能。

这里给我的感觉类似于 ICS 课程中所提到的时钟周期的概念。

### 第七章：用于 + × 算术运算的电路

在本章中，作者详细讨论了如何在 CA 上实现加法和乘法。作者首先提到了加法器的设计，然后指出了乘法器的设计可以通过多次加法来实现。作者还指出了这种设计的优势，即可以通过简单的逻辑电路来实现复杂的运算。关于乘法，他还额外提到了延迟器的设计，以解决乘法器的同步问题。

### 第八章：用于 - ÷ 算术运算的电路

在这章中，作者创造性地提出了二进制中的符号和小数点位置的规则，提出了补码系统以表示负数。其表达式如下：

$$
A = -a_n2^n + \sum_{i=0}^{n-1} a_i 2^i
$$

基于此，他还额外指出了加减法无需考虑符号和小数点位置，而在乘除法中，我们需要额外的处理。

接下来，作者依次介绍了二进制下减法和除法网络的设计：

-   对于减法，我们基于式子 `-X = ~X + 1` 来实现。作者同时给出了减法器的具体设计。
-   对于除法，我们可以基于移位和减法来实现。作者同时给出了除法器的具体设计。

### 第九章：二进制小数点

在本章中，作者详细探讨了计算机中数值运算的关键概念，尤其是乘法和除法运算。作者指出，在进行这些运算时，必须考虑二进制点的位置及符号位的处理。

深入到细节中，他还指出了在所有数值运算中，数值应控制在 -1 和 1 之间，通过调整二进制点位置和适当的舍入规则来保证计算的准确性和效率。

这和我们现今使用的 IEEE 754 浮点数标准不谋而合。

### 第十章：其他操作

在本章中，作者继续探讨了计算机中实现除了先前四则运算以外的各种算术运算的方法。他首先详细描述了平方根运算的实现过程，并与第八章中的除法运算进行了比较。这个算法略显复杂。此外，他还着重讨论了各种简化基本运算的方法（如使用对数表），并指出尽管这些方法可以简化运算，但直接实现这些运算更为高效。

最后，他还举例说明了在设计 CA 时，如何考虑哪些运算应通过硬件直接实现，哪些可以通过软件方法转化后再行处理。而正是这些考虑，使得在 CA 中包括更多的代数或分析操作变得不必要。

### 第十一章：CA 操作完整列表的组织

在本章中，作者融会贯通地总结了之前的几个章节，详细阐述了 CA（中央算数器）的设计和实现。他首先指出了 CA 的本质上被组织为除法器，这是因为其是最复杂的运算，而其他运算都可以通过适当修改它来实现。

为了正确的计算，CA 需要和内存 M 紧密地结合，为此作者提出了一个高效的数据传输方案，即通过两个连续步骤将数据从 M 传输到 CA，以及一个选择操作。这里已经有了后世流水线设计的雏形。

在本章的最后，作者还总结了 CA 所必须的十种操作，其中包括八种基本运算和两种数据制式转换操作。

### 第十二章：内存 M 的容量通用原则

在本章中，作者讨论了内存 M 的容量和基本设计原则。他首先强调了其容量就是其能记住多少个二进制数字，然后通过分析各种操作、存储的内存需求，给出了如何组织和量化这些需求的基本原则，这同时也展现了该部分设计的复杂性。在本章中，已经可以看到现代计算机体系结构中的内存层次结构的影子。最后还额外阐明了如何在解决一个问题的过程中有效地使用内存来存储所需信息，以及如何在不同计算任务之间维护和更新存储器的内容。

### 第十三章：内存 M 的组织

在本章中，作者主要是深入讨论了内存 M 的组织结构，尤其是终端器件 A（Amplifier，脉冲恢复器）和 SG（Switching and Gating，门控开关）的设计和相互作用。通过对延迟记忆体分析，提出了一种当时可行的内存组织方案与对应的物理结构。

### 第十四章：中央控制器 CC 和内存 M

在本章中，作者讨论了中央控制器 CC 和内存 M 之间的动态交互关系。作者首先给出了 CC 的定义，其功能包括接受指令、解释指令、执行指令或者控制其他部分执行指令，并接着就指令分类、转移和执行顺序各自展开了进一步的讨论。

### 第十五章：代码

在本章中，作者对前文所述思想做了系统性的综述，并给出了具体的代码实现。其中包含了对内存单元如何表示二进制数、小周期的分类与表示、标准数与指令的详细描述，以及如何通过这些小周期来逻辑控制整个设备。通过进一步区分标准数和指令，以及细分指令的不同类型，作者阐释了如何在有限的内存空间内有效且高效地表达复杂的计算操作和控制逻辑。

## 冯诺依曼结构特点分析

冯诺依曼结构是现代计算机设计的基础，其特点可以从这份草案[^1]中总结如下：

1. **五个主要组成部分**：冯诺依曼结构将计算机分为五个主要部分

    - 中央算数器（CA）
    - 中央控制器（CC）
    - 存储器（M）
    - 输入设备（I）
    - 和输出设备（O）

    这是一个十分经典的体系结构，一直沿用至今。正是这种分模块式的结构，赋予了计算机高效和灵活的方式处理数据和指令的能力。

2. **二进制逻辑**：冯诺依曼结构基于二进制进行运算，这简化了计算机的电路设计，并提高了运算速度，使之更加简单高效。二进制系统的使用是受到生物神经元的启发，其中神经元的两种状态（静息和兴奋）与二进制的 0 和 1 相对应。

3. **顺序执行和控制流**：中央控制器（CC）根据存储在存储器中的指令顺序控制程序的执行流程。这包括指令的读取、译码、执行以及对程序流的控制，如跳转语句。

4. **算术逻辑的电路设计**：中央算数器（CA）负责执行所有的算术和逻辑运算。它能够执行基本的加、减、乘、除、开方等运算，并在此基础上支持更复杂的数学运算（而不是一味的添加新的硬件逻辑增加复杂度）。

5. **输入输出机制**：输入设备（I）和输出设备（O）使得计算机能够与外部世界交互，接收输入数据和输出结果。这些设备可以是多样化的，如键盘、鼠标、显示器、打印机等。

6. **内存管理**：冯诺依曼结构不仅指出了存储器（M）同时存储数据和程序，还重点区分了内部存储和外部存储之间的关系，前者用以快速访问和执行中的数据和程序，而外部存储则用于持久化存储数据和程序。

## 当前计算设备分析对比

我选择我目前使用的 Apple 2021 款 MacBook Pro 作为分析设备[^2]。

![M1 Pro](https://cdn.arthals.ink/bed/2024/03/image-7ed0d6a6f03ad626d80ecd71cf10c807.png)

<center>
    图 1：Apple 2021 款 MacBook Pro M1 Pro 芯片<sup>[2]</sup>
</center>

![img](https://images.anandtech.com/doci/17019/2021-10-18%2019_18_37_575px.jpg)

<center>
    图 2：Apple 2021 款 MacBook Pro 统一内存<sup>[2]</sup>
</center>

这台设备采用的 M1 Pro 芯片，依照冯诺依曼结构五大组成部分分析如下：

1. **中央算数器（CA）**：M1 Pro 芯片中的 CPU 由 8 个 Firestorm 高性能核心和 2 个 Icestorm 高效能核心组成。
2. **中央控制器（CC）**：M1 Pro 芯片基于 Apple 公司自研的 ARMv8.5-A 指令集，其具有相较以往 Intel 芯片及对应的 x86-64 架构更高的能效比，且能在一些场景下具有更高的处理速度。Apple 还同时提供了 Rosetta2 以供转译基于 x86-64 编译的应用程序。这无疑为生态迁移提供了良好的基础，而没有重蹈 IA-64 的覆辙。
3. **存储器（M）**：M1 Pro 芯片内置了 16 GB 统一内存，不仅将 CPU 和内存集成在了同一块芯片上，还将 GPU 的内存也一并统一集成管理，这提高内存的利用率和性能、降低了功耗，同时实现了高带宽和低延迟的内存访问。
4. **输入输出设备（I/O）**：M1 Pro 芯片内置了多种输入输出设备，如 USB-C、Thunderbolt 4、Wi-Fi 6、蓝牙 5.0、HDMI 等，同时还支持多种外接设备，如显示器、键盘、摄像头、麦克风等。

与冯诺依曼在《关于 EDVAC 的报告草案》[^1]中描述的比较，这台现代的电脑：

-   **集成度提高**：将 CPU、GPU 和内存集成在单一芯片上，而不是草案中所描述的计算机组成部件的相对分离状态。
-   **能效优化**：M1 Pro 芯片设计强调能效比，这在冯诺依曼的时代尚未成为主要考虑的要点。
-   **统一内存管理**：M1 Pro 芯片的统一内存管理打破了传统的存储器和处理器之间的物理界限，提升了性能与效率。
-   **新的交互设备与计算机组成部分**：现代计算机不仅仅是 CPU、内存、输入输出设备的组合，还包括了 GPU 等新型组成部分，即使是原有的输入输出设备，也得到了极大的改进，在易用性和性能上都有了很大的提升。

## “非冯结构” 调研分析

这里以另外一种相对知名的计算机体系结构，即哈佛结构[^3]为例进行调研分析。

![哈佛结构](https://cdn.arthals.ink/bed/2024/03/image-1-114a5722065535bbbda894ccf3390240.png)

<center>
    图 3：哈佛架构<sup>[3]</sup>
</center>

哈佛结构和冯诺依曼结构是两种计算机体系结构的设计。以下是它们的主要特点和异同。

哈佛架构的主要特点是**将程序指令存储和数据存储分开管理**。受益于这种存储方式，中央处理器（CPU）在执行时，先从程序指令存储器中读取指令，解码后获取数据地址，然后再从数据存储器中读取数据进行操作。其采用**独立两条总线**的设计，分别连接 CPU 和两个存储器，这两个设计使得指令和数据可以同时被处理，提高了并行能力，而且允许指令和数据有不同的宽度。

由于指令访存和数据访存分离，且能各自使用不同的总线，其在相同电路的复杂度下可以比冯诺依曼结构更快地执行指令[^3]，然而这种设计同时也增加了系统的复杂度，因而需要更高的硬件成本。

### 哈佛结构与冯诺依曼结构相比

#### 相同之处

两种结构都是用于指导计算机内部组件如何组织和交互的，都具有分部式设计，且均采用二进制，都具有输入输出设备和运算器。

#### 不同之处

1. **内存的存储方式**：哈佛结构分开存储程序和数据，而冯诺依曼结构则将它们存储在同一内存中。
2. **总线设计**：哈佛结构使用独立的总线分别访问指令和数据，而冯诺依曼结构通常使用单一总线。
3. **效率**：由于哈佛结构能够同时访问指令和数据，通常在执行指令时效率更高；而冯诺依曼结构由于指令和数据共享内存和总线，可能会遇到瓶颈。

## 补充信息

冯诺依曼结构是现代计算机设计的里程碑，它为计算机的发展铺设了基础，其思想时至今日仍未过时，反而得到了进一步的发展和完善。尽管如此，其仍存在一些局限性。

### 冯诺依曼结构的局限性

根据参考资料[^4]，可以总结冯诺依曼结构的局限性如下：

1. **冯诺依曼性能瓶颈**：指令和数据混合存储在同一个存储器中，程序和数据共享同一总线，这导致了指令和数据不能同时被取出，限制了处理速度。这一点在哈佛结构中得到了相应的改进。
2. **存储器与处理速度不匹配**：随着处理器速度的提高，存储器速度的相对滞后成为性能瓶颈。现代计算机多采用多级缓存、虚拟内存等技术来缓解这一问题。
3. **指令集的限制**：指令由操作码和地址码组成，操作数本身无数据类型的标志，它的数据类型由操作码确定，这限制了指令集的灵活性和功能的扩展。
4. **安全性问题**：程序和数据存储在同一内存中，可能增加安全风险，如恶意代码执行等。
5. **功耗和散热问题**：过高的信息交换量也带来了严重的发热问题与功耗问题，这些问题成为阻拦计算机算力发展的障碍，现代计算机通过提高集成度和采用更先进的制程技术、大小核来解决这一问题。

尽管冯诺依曼结构有其固有的局限性，但随着时代的发展，计算机体系结构在不断改进以解决这种问题，如哈佛结构、超标量、超流水线、多核、GPU 等技术的出现，都是对冯诺依曼结构的一种补充和完善。

## 参考文献

[^1]: John von Neumann. First draft of a report on the EDVAC.
[^2]: Andrei Frumusanu. Apple's M1 Pro, M1 Max SoCs Investigated: New Performance and Efficiency Heights. https://www.anandtech.com/show/17024/apple-m1-max-performance-review
[^3]: Wikipedia. 哈佛架构. https://zh.wikipedia.org/wiki/%E5%93%88%E4%BD%9B%E7%BB%93%E6%9E%84
[^4]: 刘爱贵. 冯·诺依曼体系结构对计算机发展的限制. https://blog.csdn.net/liuaigui/article/details/4791835
